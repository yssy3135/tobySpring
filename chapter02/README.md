### 2.1.1 테스트의 유용성

테스트란 결국 내가 예상하고 의도 했던 대로 코드가 정확히 동작하는지를 확인해서 만든 코드를 확신할 수 있게 해주는 작업이다.

테스트의 결과가 원하는 대로 나오지 않는 경우에는 코드나 설계에 결함이 있음을 알 수 있다.

이를 통해 코드의 결함을 제거 해가는 작업 일명 디버깅을 거치게 되고, 결국 최종적으로 테스트가 성공하면 모든 결함이 제거됐다는 확신을 얻을 수 있다.

### 작은 단위의 테스트

테스트하고자 하는 대상이 명확하다면 그 대상에만 테스트하는 것이 바람직.

한꺼번에 너무 많은 것을 몰아서 테스트하면 테스트 수행 과정도 복잡해지고 오류가 발생했을 때 정확한 원인을 찾기가 힘들어진다.

테스트는 가능하면 작은 단위로 쪼개서 집중해서 할 수 있어야한다. 

관심사의 분리라는 원리가 여기에도 적용된다.

- 관심사의 분리

    관심이 같은 것끼리는 하나의 객체 안으로 또는 친한 객체로 모이게하고

    관심이 다른 것은 가능한 따로 떨어져서 서로 영향을 주지 않도록 분리하는 것 이라고 생각할 수 있다.

    관심사가 같은 것 끼리 모으로 다른 것은 분리해줌으로써 같은 관심에 효과적으로 집중할 수 있게 만들어주는것.

테스트의 관심이 다르다면 테스트할 대상을 분리하고 집중해서 접근해야 한다.

### 단위 테스트란?

**작은 단위의 코드에 대해 테스트를 수행한것.**

**단위란 그 크기와 범위가 어느 정도인지 짝 정해진 건 아니다.**

**충분히 하나의 관심에 집중해서 효율적으로 테스트할 만한 범위의 단위.**

일반적으로 단위는 작을수록 좋다.

**단위를 넘어서는 다른 코드들은 신경 쓰지 않고 참여하지도 않고 테스트가 동작 할 수 있드면 좋다.**

사용할 DB의 상태를 테스트가 관장하고 있다면 이는 단위테스트라고 해도 된다.

다만 DB의 상태가 매번 달라지고 테스트를 위해 DB를 특정 상태로 만들어줄 수 없다면 그런 차원에서 통제할 수 없는 외부의 리소스에 의존하는 테스트는 단위 테스트가 아니라고 보기도 하는 것.

전 과정을 하나로 묶어서 테스트할 필요가 있다 각 단윅 기능은 잘 동작하는데 묶어 놓으면 안되는 경우가 종종 발생하기 때문.

### 단위 테스트를 하는 이유

개발자가 설계하고 만든코드가 원래 의도한 대로 동작하는지를 개발자 스스로 빨리 확인받기 위해서.

이때 확인의 대상과 조건이 간단하고 명확 할수록 좋다.

그래서 작은 단위로 제한해서 테스트하는 것이 편리하다.

단위테스트는 주로 개발자가 만든 코드를 스스로 확인하기 위해 사용하는데

그래서 이를 개발자 테스트 또는 프로그래머 테스트 라고도 한다.

### 📍자동수행 테스트코드

테스트는 자동으로 수행되도록 코드로 만들어지는 것이 중요하다.

(코드로 만들어져서 자동으로 수행 될 수 있어야 한다는 것.)

자동으로 수행는 테스트의 장점은 자주 반복할 수 있다는 것.

번거로운 작업이 없고 테스트를 빠르게 실행할 수 있기 때문에 언제든 코드를 수정하고 나서 테스트를 해 볼수 있다.

### 지속적인 개선과 점진적인 개발을 위한 테스트

미리 만들어둔 테스트 코드는 유용하게 쓰일 수 있다. 

일단은 가장 단순한 등록과 조회 기능을 만들고 이를 테스트로 검즈앻서 만든코드에 대한 확신을 가진다.

그리고 거기에 조금씩 기능을 더 추가해가면서 그에 대한 테스트도 함께 추가하는 식으로 점진적인 개발이 가능해진다.

테스트를 이용하면 새로운 기능도 기대한 대로 동작하는지 확인할 수 있을 뿐 아니라, 기존에 만들어뒀던 기능들이 새로운 기능을 추가하느라 수정한 코드에 영향을 받지않고 여전히 잘 동작하는지를 확인할 수도 있다.

### 테스트란 개발자가 마음 편하게 잠자리에 들수 있게 해주는것.

### 포괄적인 테스트

코드의 기능을 모두 점검할 수 있는 테스트

애플리케이션은 이후에 어떤 과감한 수정르 하고 나서도 테스트를 모두 돌려보고 나면 안심이 된다.

혹은 테스트를 통해 그 변경에 영향을 받는 부분이 정확히 확인된다면 빠르게 조치를 취할 수 있다.

### JUnit

자바 테스팅 프레임워크 

자바로 단위 테스트를 만들 때 테스트 지원 도구

제어의 역전

프레임워크는 개발자가 만든 클래스에 대한 제어 권한을 넘겨받아서 주도적으로 애플리케이션의 흐름을 제어한다.

개발자가 만든 클래스의 오브젝트를 생성하고 실행하는 일은 프레임워크에 의해 진행된다.

### JUnit 프레임워크가 요구하는 조건 두가지

1. 메소드가 public으로 선언돼야 한다.
2. @Test라는 애노테이션을 붙여주는 것.

### 📍테스트 결과의 일관성 (참고 184)

반복적으로 테스트를 했을 때 테스트가 실패하기도 하고 성공하기도 한다면 이는 좋은 테스트라고 할 수 없다.

### 동일한 결과를 보장하는 테스트

코드에 변경사항이 없다면 테스트는 항상 동일한 결과를 내야 한다.

단위 테스트는 항상 일관성 있는 결과가 보장돼야 한다.

데이터와 같은 외부 환경에 영향을 받지 말아야 하는 것은 물론이고 테스트를 실행하는 순서를 바꿔도 동일한 결과가 보장되도록 만들어야한다.

가장 좋은 해결책은 테스트를 마치고 나면 테스트를 진행 하기 이전 상태로 만들어주는 것.

그러면 테스트를 아무리 여러 번 반복해서 실행하더라고 항상 동일한 결과를 얻을 수 있다.

### JUnit 테스트는 메소드의 실행 순서를 보장해주지 않는다.

테스트의 결과가 테스트 실행 순서에 영향을 받는다면 테스트를 잘못 만든 것.

모든 테스트는 실행 순서에 상관없이 독립적으로 항상 동일한 결과를 낼 수 있도록 해야 한다.

### @Test의 expeacted

expected는 테스트 메소드 실행 중에 발생하리라 기대하는 예외 클래스를 넣어주면된다.

보통의 테스트와는 반대로 정상적으로 테스트메소드를 마치면 테스트가 실패하고

expected에서 지정한 예외가 던져지면 테스트가 성공한다.

예외가 반드시 발생해야 하는 경우에 테스트하고 싶을 때 유용하게 쓸수 있다.

### 포괄적인 테스트

성의 없이 테스트를 만드는 바람에 문자가 있는 코드인데도 테스트가 성공하게 만드는 건 더 위험하다.

한가지 결과만 검증하고 마는 것은 상당히 위험하다.

종종 단순하고 간단한 테스트가 치명적일 실수를 피할 수 있게 해주기도 한다.

개발자가 테스트를 직접만들 때 자주 하는 실수가 바로 성공하는 테스트만 골라서 만드는 것.

스프리으이 창시자인 로드 존슨은 "항상 네거티브 테스트를 먼저 만들라"

테스트를 작성할 때 부정적인 케이스를 먼저 만드는 습관을 들이는 게 좋다.

그러면 예외적인 상황을 빠뜨리지 않는 꼼꼼한 개발이 가능하다.

### 📍테스트가 이끄는 개발 p.176

추가하고 싶은 기능을 일반 언어가 아니라 테스트 코드로 표현해서 코드로 된 설계문서처럼 만든다면

실제 기능을 가진 애플리케이션 코드를 설계한 대로 코드가 동작하는지를 빠르게 검증 할 수 있다.

테스트가 실패하면 이때는 설계한 대로 코드가 만들어지지 않았음을 바로 알 수 있다.

그리고 문제가 되는 부분이 무엇인지에 대한 정보도 테스트 결과를 통해 얻을 수 있다.

다시 코드를 수정하고 테스트를 수행해서 테스트가 성공하도록 애플리케이션 코드를 계속 다듬는다.

테스트가 성공한다면 그 순간 코드 구현과 테스트라는 두 가지 작업이 동시에 끝나는 것이다.

### 테스트 주도 개발

만들고자 하는 기능의 내용을 담고 있으면서 만들어진 코드를 검증도 해줄 수 있도록 테스트 코드를 먼저 만들고 테스트를 성공하게 해주는 코드를 작성하는 방식의 개발 방법

**TDD의 기본 원칙**

실패한 테스트를 성공시키기 위한 목적이 아는 코드는 만들지 않는다.

이 원칙을 따랐다면 만들어진 모든 코드는 빠짐없이 테스트로 검증된 것.

### TDD의 장점

1. 테스트를 성공하도록 하는 코드만 만드는 식으로 진행하기 때문에 테스트를 빼먹지 않고 꼼꼼하게 만들어 낼 수 있다.
2. 테스트를 작성하는 시간과 애플리케이션 코드를 작성하는 시간의 간격이 짧아진다.
사실 0 에 가깜다. 테스트를 만들어 뒀기 때문에 코드를 작성하면 바로바로 테스트할 수 있다.
3. 그 덕분에 피드백을 매우 빠르게 받을 수 있다.
4. 작성한 코드에 확신을 가질 수 있다.
5. 코드를 만들어 테스트를 실행하는 그 사이의 간격이 매우 짧다.
오류를 빨리 발견할 수 있고 쉽게 대응이 가능하다.
6. 테스트 덕분에 오류를 빨리 잡아낼 수 있어서 전체적인 개발 속도는 오히려 빨라진다.

### TDD에서는 테스트를 작성하고 이를 성공시키는 코드를 만드는 작업의 주기를 가능한 짧게 가져가도록 권장한다.

TDD를 하면 자연스럽게 단위 테스트를 만들 수 있다.
빠르게 자동으로 실행할 수 있는 단위 테스트가 아니고서는 이런 식의 개발은 거의 불가능 하다.

### @Autowired 변수 타입과 일치하는 컨텍스트 내의 빈을 찾는다.

타입이 일치하는 빈이 있으면 인스턴스 변수에 주입해준다.

메소드가 없어도 주입이 가능하다.

변도의 DI 설정 없이 필드의 타입정보를 이용해 빈을 자동으로 가져올 수 있다.